from flask import Flask, request, jsonify
import random
from datetime import datetime

app = Flask(__name__)

class NatiqAI:
    def __init__(self):
        self.models = {
            "ููุงูู ูุจูุงฺฏ": self._generate_blog,
            "ูพุณุช ุดุจฺฉู ุงุฌุชูุงุน": self._generate_social,
            "ุงูู ุจุงุฒุงุฑุงุจ": self._generate_email,
            "ฺฏุฒุงุฑุด ูู": self._generate_report,
            "ูุญุชูุง ูุญุตูู": self._generate_product
        }
        
    def _generate_blog(self, topic, style):
        templates = [
            f"""# {topic}

## ููุฏูู
ุฏุฑ ุงู ููุงูู ุฌุงูุน ุจู ุจุฑุฑุณ {topic} ูโูพุฑุฏุงุฒู. ุงู ููุถูุน ุฏุฑ ุณุงูโูุง ุงุฎุฑ ุชูุฌู ุจุณุงุฑ ุงุฒ ูุญููุงู ู ูุชุฎุตุตุงู ุฑุง ุจู ุฎูุฏ ุฌูุจ ฺฉุฑุฏู ุงุณุช.

## ุชุญูู ูุญุชูุง
ุจุฑ ุงุณุงุณ ุขุฎุฑู ุงูุชูโูุง ุนููุ {topic} ุชุงุซุฑ ูุงุจู ุชูุฌู ุฏุฑ ุญูุฒูโูุง ูุฎุชูู ุฏุงุดุชู ุงุณุช. 

### ูฺฉุงุช ฺฉูุฏ:
- ุจูุจูุฏ ูุฑุขูุฏูุง ููุฌูุฏ
- ุงุฌุงุฏ ูุฑุตุชโูุง ุฌุฏุฏ
- ุงูุฒุงุด ุจูุฑูโูุฑ

## ูุชุฌูโฺฏุฑ
{topic} ุจุฏูู ุดฺฉ ููุด ููู ุฏุฑ ุขูุฏู ุฎูุงูุฏ ุฏุงุดุช.""",
            f"""# {topic}: ุจุฑุฑุณ ฺฉุงูู

## ฺุฑุง {topic} ููู ุงุณุชุ
{topic} ฺฉ ุงุฒ ูุจุงุญุซ ุฏุงุบ ู ูพุฑุทุฑูุฏุงุฑ ุฏุฑ ุญูุฒู ุชฺฉููููฺ ูุญุณูุจ ูโุดูุฏ.

## ูุฒุงุง ุงุตู
- **ฺฉุงุฑุง ุจุงูุง**: ุนููฺฉุฑุฏ ุจููู ุฏุฑ ุดุฑุงุท ูุฎุชูู
- **ููุงุณโูพุฐุฑ**: ูุงุจูุช ุฑุดุฏ ู ุชูุณุนู
- **ุงูุนุทุงูโูพุฐุฑ**: ุณุงุฒฺฏุงุฑ ุจุง ูุงุฒูุง ูุชููุน

## ฺุดูโุงูุฏุงุฒ ุขูุฏู
ูพุดโุจู ูโุดูุฏ {topic} ุฏุฑ ูพูุฌ ุณุงู ุขูุฏู ุชุญููุงุช ุจุฒุฑฺฏ ุงุฌุงุฏ ฺฉูุฏ."""
        ]
        return random.choice(templates)
    
    def _generate_social(self, topic, style):
        return f"""๐ฏ {topic} - ุชุญูู ุดฺฏูุชโุงูฺฏุฒ!

โจ ุขูุงุฏูโุงุฏ ุจุง {topic} ุขุดูุง ุดูุฏุ

โ ูุฒุช ุงูู: ุตุฑููโุฌู ูููโุงูุนุงุฏู
โ ูุฒุช ุฏูู: ุงูุฒุงุด ฺฉุงุฑุง
โ ูุฒุช ุณูู: ฺฉุงูุด ูุฒููโูุง

๐ก ูฺฉุชู ูฺู: ููู ุงูุฑูุฒ ุดุฑูุน ฺฉูุฏ!

#{topic.replace(' ', '')} #ุชฺฉููููฺ #ููุขูุฑ"""
    
    def _generate_email(self, topic, style):
        return f"""ููุถูุน: ูุฑุตุช ุงุณุชุซูุง ุฏุฑ ุฒููู {topic}

ุณูุงูุ

ุงูุฏูุงุฑู ุงู ูพุงู ุฑุง ุฏุฑ ุณูุงูุช ฺฉุงูู ุฏุฑุงูุช ฺฉุฑุฏู ุจุงุดุฏ.

ูุง ููุชุฎุฑู ฺฉู ุฎุฏูุงุช ุญุฑููโุง ุฎูุฏ ุฏุฑ ุฒููู {topic} ุฑุง ุจู ุดูุง ูุนุฑู ฺฉูู.

**ูุฒุงุง ฺฉูุฏ:**
๐ธ ุตุฑููโุฌู ุฏุฑ ุฒูุงู ู ูุฒูู
๐ธ ุงูุฒุงุด ฺฉูุช ุฎุฑูุฌ
๐ธ ูพุดุชุจุงู ุชุฎุตุต

ุจุง ุงุญุชุฑุงูุ
ุชู Natiq Mosatalah"""
    
    def _generate_report(self, topic, style):
        return f"""ฺฏุฒุงุฑุด ูู: {topic}

ุชุงุฑุฎ ุชูู: {datetime.now().strftime('%Y-%m-%d')}

ุฎูุงุตู ุงุฌุฑุง:
ุงู ฺฏุฒุงุฑุด ุจู ุชุญูู {topic} ูโูพุฑุฏุงุฒุฏ.

ุงูุชูโูุง ฺฉูุฏ:
1. ูพุชุงูุณู ุฑุดุฏ ุจุงูุง
2. ุจุงุฒุงุฑ ุฏุฑ ุญุงู ุชูุณุนู
3. ุชูุงุถุง ุฑูุฒุงูุฒูู

ุชูุตูโูุง:
- ุณุฑูุงูโฺฏุฐุงุฑ ุจููุฏูุฏุช
- ุชูุณุนู ุชุฎุตุต ูุฑู ุงูุณุงู
- ุจูุฑูโฺฏุฑ ุงุฒ ุชฺฉููููฺโูุง ุฑูุฒ"""
    
    def _generate_product(self, topic, style):
        return f"""# {topic} - ุฑุงูโุญู ููุขูุฑุงูู

## ูุนุฑู
{topic} ูุญุตูู ูพุดุฑูุชู ุจุฑุง ูพุงุณุฎฺฏู ุจู ูุงุฒูุง ุงูุฑูุฒ ุจุงุฒุงุฑ ุงุณุช.

## ูฺฺฏโูุง ููุญุตุฑ ุจู ูุฑุฏ
- ุทุฑุงุญ ฺฉุงุฑุจุฑูพุณูุฏ
- ุนููฺฉุฑุฏ ุจููู
- ูพุดุชุจุงู ฺฉุงูู

## ฺฉุงุฑุจุฑุฏูุง
โข ฺฉุณุจโูฺฉุงุฑูุง ฺฉูฺฺฉ ู ูุชูุณุท
โข ุณุงุฒูุงูโูุง ุจุฒุฑฺฏ
โข ุงุณุชุงุฑุชุงูพโูุง"""

    def generate(self, topic, content_type, style="ุฑุณู"):
        generator = self.models.get(content_type, self._generate_blog)
        return generator(topic, style)

natiq_ai = NatiqAI()

@app.route('/api/generate', methods=['POST'])
def generate_content():
    data = request.json
    topic = data.get('topic', '')
    content_type = data.get('content_type', 'ููุงูู ูุจูุงฺฏ')
    style = data.get('style', 'ุฑุณู')
    
    if not topic:
        return jsonify({'error': 'ููุถูุน ุฑุง ูุงุฑุฏ ฺฉูุฏ'}), 400
    
    content = natiq_ai.generate(topic, content_type, style)
    
    return jsonify({
        'content': content,
        'model': 'natiq-mosatalah-ai',
        'word_count': len(content.split()),
        'timestamp': datetime.now().isoformat()
    })

@app.route('/health')
def health():
    return jsonify({'status': 'healthy', 'service': 'Natiq Mosatalah AI'})

@app.route('/')
def home():
    return "๐ง Natiq Mosatalah AI Service - Active"

if __name__ == '__main__':
    print("๐ Natiq Mosatalah AI Running on: http://localhost:8001")
    app.run(host='0.0.0.0', port=8001, debug=True)
