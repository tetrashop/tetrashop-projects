<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù‡ÙˆØ´ Ù†Ú¯Ø§Ø± - ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700&display=swap');
        
        * {
            font-family: 'Vazirmatn', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 25px;
            border-radius: 15px;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 1.1em;
            color: #2c3e50;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #bdc3c7;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: #3498db;
            outline: none;
        }
        
        .btn-generate {
            background: linear-gradient(135deg, #e67e22, #e74c3c);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 12px;
            font-size: 18px;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s;
        }
        
        .btn-generate:hover {
            transform: translateY(-2px);
        }
        
        .btn-generate:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }
        
        .result {
            margin-top: 40px;
            padding: 25px;
            background: #ecf0f1;
            border-radius: 15px;
            border-right: 6px solid #27ae60;
            display: none;
        }
        
        .result h3 {
            margin-top: 0;
            color: #27ae60;
            border-bottom: 2px solid #bdc3c7;
            padding-bottom: 10px;
        }
        
        .section {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .section-title {
            color: #2c3e50;
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        .section-title::before {
            content: "ğŸ“Œ";
            margin-left: 8px;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            font-size: 1.2em;
            color: #7f8c8d;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #27ae60;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #7f8c8d;
        }
        
        .error {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>âœï¸ Ù‡ÙˆØ´ Ù†Ú¯Ø§Ø±</h1>
            <p>Ø³ÛŒØ³ØªÙ… Ù‡ÙˆØ´Ù…Ù†Ø¯ ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§ Ùˆ Ù†ÙˆÛŒØ³Ù†Ø¯Ú¯ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±</p>
            <p style="font-size: 0.9em; opacity: 0.8;">Ù‚Ø¯Ø±Øª Ú¯Ø±ÙØªÙ‡ Ø§Ø² Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ</p>
        </div>

        <div id="connection-status" class="error" style="display: none;">
            âš ï¸ Ø³Ø±ÙˆØ± ÙˆØµÙ„ Ù†ÛŒØ³Øª. Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ Ø³Ø±ÙˆØ± Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§Ø³Øª.
        </div>

        <div class="form-group">
            <label for="topic">ğŸ¯ Ù…ÙˆØ¶ÙˆØ¹ Ù…Ø­ØªÙˆØ§:</label>
            <input type="text" id="topic" placeholder="Ù…Ø«Ø§Ù„: Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒØŒ ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒØŒ Ù…Ø­ÛŒØ· Ø²ÛŒØ³ØªØŒ Ø¢Ù…ÙˆØ²Ø´ Ø¯ÛŒØ¬ÛŒØªØ§Ù„..." value="Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ">
        </div>

        <div class="form-group">
            <label for="template">ğŸ“„ Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§:</label>
            <select id="template">
                <option value="Ù…Ù‚Ø§Ù„Ù‡">ğŸ“– Ù…Ù‚Ø§Ù„Ù‡ Ø¹Ù„Ù…ÛŒ</option>
                <option value="Ú¯Ø²Ø§Ø±Ø´">ğŸ“Š Ú¯Ø²Ø§Ø±Ø´ ØªØ­Ù„ÛŒÙ„ÛŒ</option>
                <option value="Ø¯Ø§Ø³ØªØ§Ù†">ğŸ“š Ø¯Ø§Ø³ØªØ§Ù† Ø®Ù„Ø§Ù‚Ø§Ù†Ù‡</option>
            </select>
        </div>

        <div class="form-group">
            <label for="length">ğŸ“ Ø·ÙˆÙ„ Ù…Ø­ØªÙˆØ§:</label>
            <select id="length">
                <option value="short">Ú©ÙˆØªØ§Ù‡ (Û² Ø¨Ø®Ø´) - Ø­Ø¯ÙˆØ¯ Û±Û°Û° Ú©Ù„Ù…Ù‡</option>
                <option value="medium" selected>Ù…ØªÙˆØ³Ø· (Û´ Ø¨Ø®Ø´) - Ø­Ø¯ÙˆØ¯ Û²Û°Û° Ú©Ù„Ù…Ù‡</option>
                <option value="long">Ø·ÙˆÙ„Ø§Ù†ÛŒ (Û¶ Ø¨Ø®Ø´) - Ø­Ø¯ÙˆØ¯ ï¼“Û°Û° Ú©Ù„Ù…Ù‡</option>
            </select>
        </div>

        <button class="btn-generate" onclick="generateContent()">
            ğŸš€ ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯
        </button>

        <div id="loading" class="loading" style="display: none;">
            <div>â³ Ø¯Ø± Ø­Ø§Ù„ ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§...</div>
            <div style="font-size: 0.9em; margin-top: 10px; color: #95a5a6;">
                Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ù†ÙˆØ´ØªÙ† Ù…Ø­ØªÙˆØ§ÛŒ Ø´Ù…Ø§Ø³Øª
            </div>
        </div>

        <div id="result" class="result">
            <h3>ğŸ“– Ù…Ø­ØªÙˆØ§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡</h3>
            <div class="stats" id="stats"></div>
            <div id="content"></div>
            <button class="btn-generate" onclick="generateContent()" style="margin-top: 20px; background: linear-gradient(135deg, #3498db, #2980b9);">
                ğŸ”„ ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§ÛŒ Ø¬Ø¯ÛŒØ¯
            </button>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';
        
        // Ø¨Ø±Ø±Ø³ÛŒ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ù‡Ù†Ú¯Ø§Ù… Ù„ÙˆØ¯ ØµÙØ­Ù‡
        window.addEventListener('load', async () => {
            try {
                const response = await fetch(`${API_BASE}/api/generate?topic=test&template=Ù…Ù‚Ø§Ù„Ù‡&length=short`, {
                    method: 'GET',
                    signal: AbortSignal.timeout(2000)
                });
                document.getElementById('connection-status').style.display = 'none';
            } catch (error) {
                document.getElementById('connection-status').style.display = 'block';
            }
        });

        async function generateContent() {
            const topic = document.getElementById('topic').value;
            const template = document.getElementById('template').value;
            const length = document.getElementById('length').value;

            if (!topic.trim()) {
                alert('Ù„Ø·ÙØ§Ù‹ Ù…ÙˆØ¶ÙˆØ¹ Ù…Ø­ØªÙˆØ§ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }

            // Ù†Ù…Ø§ÛŒØ´ loading
            const button = document.querySelector('.btn-generate');
            const loading = document.getElementById('loading');
            const result = document.getElementById('result');
            
            button.innerHTML = 'â³ Ø¯Ø± Ø­Ø§Ù„ ØªÙˆÙ„ÛŒØ¯...';
            button.disabled = true;
            loading.style.display = 'block';
            result.style.display = 'none';

            try {
                const apiUrl = `${API_BASE}/api/generate?topic=${encodeURIComponent(topic)}&template=${template}&length=${length}`;
                console.log('Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡:', apiUrl);
                
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`Ø®Ø·Ø§ÛŒ Ø³Ø±ÙˆØ±: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    displayContent(data.data);
                } else {
                    throw new Error(data.message || 'Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡');
                }
            } catch (error) {
                console.error('Ø®Ø·Ø§:', error);
                alert('Ø®Ø·Ø§ Ø¯Ø± ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§: ' + error.message + '\n\nÙ…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ Ø³Ø±ÙˆØ± Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§Ø³Øª (python3 web_writer.py)');
            } finally {
                button.innerHTML = 'ğŸš€ ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯';
                button.disabled = false;
                loading.style.display = 'none';
            }
        }

        function displayContent(content) {
            const resultDiv = document.getElementById('result');
            const contentDiv = document.getElementById('content');
            const statsDiv = document.getElementById('stats');
            
            // Ù†Ù…Ø§ÛŒØ´ Ø¢Ù…Ø§Ø±
            statsDiv.innerHTML = `
                <div class="stat-item">
                    <div class="stat-value">${content.word_count}</div>
                    <div class="stat-label">ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${Object.keys(content.sections).length}</div>
                    <div class="stat-label">ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø®Ø´â€ŒÙ‡Ø§</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${content.type}</div>
                    <div class="stat-label">Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${content.length}</div>
                    <div class="stat-label">Ø·ÙˆÙ„ Ù…Ø­ØªÙˆØ§</div>
                </div>
            `;
            
            // Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØªÙˆØ§
            let html = `
                <div class="section">
                    <div class="section-title">Ø¹Ù†ÙˆØ§Ù† Ù…Ø­ØªÙˆØ§</div>
                    <div>${content.title}</div>
                </div>
                
                <div class="section">
                    <div class="section-title">Ø³Ø§Ø®ØªØ§Ø± Ù…Ø­ØªÙˆØ§</div>
                    <div style="color: #7f8c8d; font-size: 0.9em;">
                        ${Object.keys(content.sections).join(' â†’ ')}
                    </div>
                </div>
            `;
            
            // Ù†Ù…Ø§ÛŒØ´ Ù‡Ø± Ø¨Ø®Ø´
            for (const [section, text] of Object.entries(content.sections)) {
                html += `
                    <div class="section">
                        <div class="section-title">${section}</div>
                        <div style="line-height: 1.8; text-align: justify;">${text}</div>
                    </div>
                `;
            }
            
            // Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¶Ø§ÙÛŒ
            html += `
                <div class="section">
                    <div class="section-title">ğŸ“‹ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙˆÙ„ÛŒØ¯</div>
                    <div style="font-size: 0.9em; color: #7f8c8d;">
                        <strong>Ø²Ù…Ø§Ù† ØªÙˆÙ„ÛŒØ¯:</strong> ${content.generated_at}<br>
                        <strong>Ù†Ø³Ø®Ù‡:</strong> ${content.version}
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            resultDiv.style.display = 'block';
            
            // Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ Ù†ØªØ§ÛŒØ¬
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Enter Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ù…Ø­ØªÙˆØ§
        document.getElementById('topic').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                generateContent();
            }
        });
    </script>
</body>
</html>
