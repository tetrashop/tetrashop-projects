"use strict";(()=>{var e={};e.id=925,e.ids=[925],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5585:(e,s,t)=>{t.r(s),t.d(s,{headerHooks:()=>m,originalPathname:()=>v,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>d,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>g});var r={};t.r(r),t.d(r,{GET:()=>GET,POST:()=>POST}),t(8976);var a=t(884),o=t(6132),i=t(5798);let n=new Map,u={nlp:"پلتفرم پروژه‌های NLP فارسی",chess:"شطرنج هوشمند Tetris-Chess",ocr:"سامانه ضد چندپارگی OCR",garden:"باغ رازآلود",assistant:"دستیار هوشمند فارسی"};async function POST(e){try{let s=await e.json();console.log("\uD83D\uDCE6 بدنه دریافتی:",JSON.stringify(s));let{serviceId:t,serviceName:r,userEmail:a="user@tetrasaas.ir"}=s;if(!t||!r)return console.log("❌ پارامترهای ناقص:",{serviceId:t,serviceName:r}),i.Z.json({success:!1,error:"پارامترهای ورودی ناقص",message:"لطفاً شناسه سرویس (serviceId) و نام سرویس (serviceName) را ارسال کنید."},{status:400});let o=t.toString().toLowerCase().trim();console.log("\uD83D\uDD0D شناسه سرویس:",o);let c=o,l="";if(!isNaN(Number(o))||o.toLowerCase().startsWith("nlp"))c="nlp",l=`پروژه NLP شماره ${o}`,console.log("✅ شناسه NLP تشخیص داده شد:",o);else{if(!u[o])return console.log("❌ سرویس نامعتبر:",o),i.Z.json({success:!1,error:"سرویس نامعتبر",message:`سرویس "${t}" پشتیبانی نمی‌شود.`,validServices:["nlp (یا هر عددی)",...Object.keys(u)]},{status:404});c=o,l=u[o]}let p=Date.now(),d=Math.random().toString(36).substring(2,15),m=`tetra_${c}_${o}_${p}_${d}`,g=new Date(p+2592e6),v=`sub_${p}`,b={id:v,serviceId:c,projectId:o,serviceName:l||r,apiKey:m,userEmail:a,expiresAt:g,createdAt:new Date(p),requestCount:0,isActive:!0,tier:"free"};n.set(v,b),console.log("✅ اشتراک ایجاد شد:",v);let f={success:!0,message:`اشتراک "${l||r}" با موفقیت فعال شد!`,data:{subscriptionId:v,apiKey:m,projectId:o,expiresAt:g.toLocaleDateString("fa-IR"),endpoint:`https://api.tetrasaas.ir/v1/${c}/${o}`,documentation:`/nlp/${o}`,limits:{dailyRequests:1e3,monthlyRequests:3e4,rateLimit:"10 درخواست در ثانیه"}}};return console.log("\uD83D\uDCE4 پاسخ ارسالی:",f),i.Z.json(f,{status:201})}catch(e){return console.error("❌ خطا در ایجاد اشتراک:",e),i.Z.json({success:!1,error:"خطای سرور",message:"سرور در پردازش درخواست با مشکل مواجه شد.",details:e instanceof Error?e.message:"خطای ناشناخته"},{status:500})}}async function GET(e){let s=e.nextUrl.searchParams,t=s.get("apiKey");if(!t)return i.Z.json({success:!1,error:"کلید API الزامی است"},{status:400});let r=Array.from(n.values()).find(e=>e.apiKey===t);return r?i.Z.json({success:!0,data:{serviceName:r.serviceName,projectId:r.projectId,expiresAt:r.expiresAt.toLocaleDateString("fa-IR"),requestCount:r.requestCount,isActive:r.isActive}}):i.Z.json({success:!1,error:"اشتراک یافت نشد"},{status:404})}let c=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/subscribe/route",pathname:"/api/subscribe",filename:"route",bundlePath:"app/api/subscribe/route"},resolvedPagePath:"/data/data/com.termux/files/home/tetrashop-projects/nlp-project/app/api/subscribe/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:p,serverHooks:d,headerHooks:m,staticGenerationBailout:g}=c,v="/api/subscribe/route"}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[955],()=>__webpack_exec__(5585));module.exports=t})();