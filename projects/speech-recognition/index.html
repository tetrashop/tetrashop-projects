<!DOCTYPE html>
<html style="height:100%;">
<head>
<link rel="stylesheet" href="/style.css">
    <title>ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± ÙØ§Ø±Ø³ÛŒ | ØªØªØ±Ø§Ø´Ø§Ù¾</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { 
            font-family: 'Vazirmatn', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }
        header {
            background: linear-gradient(to right, #1a237e, #283593);
            padding: 30px;
            text-align: center;
        }
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            padding: 30px;
        }
        .recognition-area {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 25px;
        }
        .visualizer {
            background: rgba(0, 0, 0, 0.3);
            height: 150px;
            border-radius: 10px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }
        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-family: 'Vazirmatn';
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn-primary {
            background: linear-gradient(45deg, #2196F3, #21CBF3);
            color: white;
        }
        .btn-success {
            background: linear-gradient(45deg, #4CAF50, #8BC34A);
            color: white;
        }
        .btn-danger {
            background: linear-gradient(45deg, #F44336, #FF9800);
            color: white;
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(0,0,0,0.3);
        }
        .transcript {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            min-height: 200px;
            margin-top: 20px;
            line-height: 1.8;
            font-size: 18px;
        }
        .sidebar {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 25px;
        }
        .back-btn {
            display: inline-block;
            margin-top: 30px;
            padding: 12px 30px;
            background: #2196F3;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
        }
        .back-btn:hover {
            background: #1976D2;
            transform: scale(1.05);
        }
        .language-badge {
            display: inline-block;
            padding: 5px 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            margin: 5px;
        }
        .wave-bar {
            position: absolute;
            bottom: 0;
            width: 10px;
            background: #4FC3F7;
            border-radius: 5px 5px 0 0;
            transition: height 0.1s;
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vazirmatn@33.003/font.css">
</head>
<body style="margin:0;padding:0;min-height:100vh;">
    <div class="container">
        <header>
            <h1>ğŸ¤ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± ÙØ§Ø±Ø³ÛŒ</h1>
            <p>ØªØ¨Ø¯ÛŒÙ„ Ú¯ÙØªØ§Ø± Ø¨Ù‡ Ù…ØªÙ† Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ Ùˆ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</p>
            <div style="margin-top: 20px;">
                <span class="language-badge">ÙØ§Ø±Ø³ÛŒ (Ø§ÛŒØ±Ø§Ù†)</span>
                <span class="language-badge">Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ (Ø¢Ù…Ø±ÛŒÚ©Ø§)</span>
                <span class="language-badge">Ø¹Ø±Ø¨ÛŒ</span>
            </div>
        </header>
        
        <div class="main-content">
            <div class="recognition-area">
                <h3>ğŸ™ï¸ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ø²Ù†Ø¯Ù‡</h3>
                <p>Ø¯Ú©Ù…Ù‡ "Ø´Ø±ÙˆØ¹ Ø¶Ø¨Ø·" Ø±Ø§ ÙØ´Ø§Ø± Ø¯Ø§Ø¯Ù‡ Ùˆ ØµØ­Ø¨Øª Ú©Ù†ÛŒØ¯...</p>
                
                <div class="visualizer" id="audioVisualizer">
                    <!-- Ù†ÙˆØ§Ø±Ù‡Ø§ÛŒ Ù…ÙˆØ¬ ØµÙˆØªÛŒ Ø§ÛŒÙ†Ø¬Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #aaa; text-align: center;">
                        <p>ğŸ“Š Ù†Ù…Ø§ÛŒØ´Ú¯Ø± Ø³Ø·Ø­ ØµØ¯Ø§</p>
                        <p id="volumeLevel">Ø³Ø·Ø­: Û°Ùª</p>
                    </div>
                </div>
                
                <div class="controls">
                    <button class="btn btn-primary" onclick="startRecording()" id="startBtn">
                        ğŸ¤ Ø´Ø±ÙˆØ¹ Ø¶Ø¨Ø·
                    </button>
                    <button class="btn btn-success" onclick="stopRecording()" id="stopBtn" disabled>
                        â¹ï¸ ØªÙˆÙ‚Ù Ø¶Ø¨Ø·
                    </button>
                    <button class="btn" onclick="clearTranscript()" style="background: #607D8B; color: white;">
                        ğŸ—‘ï¸ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…ØªÙ†
                    </button>
                    <button class="btn btn-danger" onclick="playTextToSpeech()">
                        ğŸ”Š Ù¾Ø®Ø´ Ø¨Ù‡ ØµÙˆØ±Øª ØµÙˆØªÛŒ
                    </button>
                </div>
                
                <div style="margin-top: 30px;">
                    <h4>ğŸ“ Ù…ØªÙ† ØªØ¨Ø¯ÛŒÙ„ Ø´Ø¯Ù‡:</h4>
                    <div class="transcript" id="transcript">
                        Ù…Ù†ØªØ¸Ø± ØµØ­Ø¨Øª Ø´Ù…Ø§ Ù‡Ø³ØªÙ…... Ù„Ø·ÙØ§ Ø¯Ú©Ù…Ù‡ "Ø´Ø±ÙˆØ¹ Ø¶Ø¨Ø·" Ø±Ø§ ÙØ´Ø§Ø± Ø¯Ù‡ÛŒØ¯.
                    </div>
                </div>
                
                <div style="margin-top: 30px; display: flex; gap: 15px; align-items: center;">
                    <label style="display: flex; align-items: center; gap: 10px;">
                        <input type="checkbox" id="autoPunctuation" checked>
                        Ø§ÙØ²ÙˆØ¯Ù† Ø®ÙˆØ¯Ú©Ø§Ø± Ø¹Ù„Ø§Ø¦Ù… Ù†Ú¯Ø§Ø±Ø´ÛŒ
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px;">
                        <input type="checkbox" id="filterNoise" checked>
                        ÙÛŒÙ„ØªØ± Ù†ÙˆÛŒØ² Ù…Ø­ÛŒØ·
                    </label>
                </div>
            </div>
            
            <div class="sidebar">
                <h3>âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª</h3>
                <div style="margin-top: 20px;">
                    <label>Ø³Ø±Ø¹Øª ØªØ´Ø®ÛŒØµ:</label>
                    <input type="range" min="1" max="10" value="5" id="speedSlider" style="width: 100%; margin: 10px 0;">
                    <div style="display: flex; justify-content: space-between;">
                        <span>Ú©Ù†Ø¯</span>
                        <span>Ø³Ø±ÛŒØ¹</span>
                    </div>
                </div>
                
                <div style="margin-top: 25px;">
                    <label>Ø­Ø³Ø§Ø³ÛŒØª Ù…ÛŒÚ©Ø±ÙˆÙÙˆÙ†:</label>
                    <input type="range" min="1" max="100" value="70" id="sensitivitySlider" style="width: 100%; margin: 10px 0;">
                    <div id="sensitivityValue">Û·Û°Ùª</div>
                </div>
                
                <h3 style="margin-top: 30px;">ğŸ“Š Ø¢Ù…Ø§Ø±</h3>
                <div style="margin-top: 15px; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px;">
                    <p>ğŸ•’ Ù…Ø¯Øª Ø²Ù…Ø§Ù† Ø¶Ø¨Ø·: <span id="recordTime">Û°Û°:Û°Û°</span></p>
                    <p>ğŸ“– Ú©Ù„Ù…Ø§Øª ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡: <span id="wordCount">Û°</span></p>
                    <p>ğŸ¯ Ø¯Ù‚Øª ØªØ´Ø®ÛŒØµ: <span id="accuracyRate">Û¹Û²Ùª</span></p>
                    <p>ğŸ’¾ Ø¢Ø®Ø±ÛŒÙ† Ø°Ø®ÛŒØ±Ù‡: <span id="lastSave">--:--</span></p>
                </div>
                
                <h3 style="margin-top: 30px;">ğŸ“‹ Ø¯Ø³ØªÙˆØ±Ø§Øª ØµÙˆØªÛŒ</h3>
                <div style="margin-top: 15px; font-size: 14px;">
                    <p>Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ú¯ÙˆÛŒÛŒØ¯:</p>
                    <ul style="padding-right: 20px;">
                        <li>"Ù†Ù‚Ø·Ù‡" â†’ .</li>
                        <li>"ÙˆÛŒØ±Ú¯ÙˆÙ„" â†’ ,</li>
                        <li>"Ø®Ø· Ø¬Ø¯ÛŒØ¯" â†’ â†µ</li>
                        <li>"Ù¾Ø§Ú© Ú©Ù†" â†’ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…ØªÙ†</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div style="padding: 30px; background: rgba(0,0,0,0.2);">
            <h3>ğŸ¯ Ú©Ø§Ø±Ø¨Ø±Ø¯Ù‡Ø§</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px;">
                    <h4>ğŸ“ Ø±ÙˆÙ†ÙˆÛŒØ³ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±</h4>
                    <p>ØªØ¨Ø¯ÛŒÙ„ Ù…ØµØ§Ø­Ø¨Ù‡â€ŒÙ‡Ø§ Ùˆ Ø³Ø®Ù†Ø±Ø§Ù†ÛŒâ€ŒÙ‡Ø§ Ø¨Ù‡ Ù…ØªÙ†</p>
                </div>
                <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px;">
                    <h4>ğŸ® Ú©Ù†ØªØ±Ù„ ØµÙˆØªÛŒ</h4>
                    <p>Ú©Ù†ØªØ±Ù„ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ø¯Ø³ØªÙˆØ±Ø§Øª ØµÙˆØªÛŒ ÙØ§Ø±Ø³ÛŒ</p>
                </div>
                <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px;">
                    <h4>ğŸ§  Ø¯Ø³ØªÛŒØ§Ø± ØµÙˆØªÛŒ</h4>
                    <p>Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø³ØªÛŒØ§Ø±Ù‡Ø§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ ÙØ§Ø±Ø³ÛŒâ€ŒØ²Ø¨Ø§Ù†</p>
                </div>
            </div>
        </div>
        
        <div style="text-align: center; padding: 30px;">
            <a href="/" class="back-btn">â† Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a>
        </div>
    </div>
    
    <script>
        const transcript = document.getElementById('transcript');
        const audioVisualizer = document.getElementById('audioVisualizer');
        const volumeLevel = document.getElementById('volumeLevel');
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const sensitivitySlider = document.getElementById('sensitivitySlider');
        const sensitivityValue = document.getElementById('sensitivityValue');
        const recordTime = document.getElementById('recordTime');
        const wordCount = document.getElementById('wordCount');
        
        let isRecording = false;
        let recordingTimer = 0;
        let timerInterval;
        let waveBars = [];
        
        // Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ú¯ÙØªØ§Ø±ÛŒ ÙØ§Ø±Ø³ÛŒ
        const persianSamples = [
            "Ø³Ù„Ø§Ù… Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ Ø¨Ù‡ Ø³ÛŒØ³ØªÙ… ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± ÙØ§Ø±Ø³ÛŒ",
            "Ø§Ù…Ø±ÙˆØ² Ø±ÙˆØ² Ø®ÙˆØ¨ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø§ÛŒÙ† Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§Ø³Øª",
            "Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù…ØªÙ† Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø§ ØµØ¯Ø§ÛŒ Ø¨Ù„Ù†Ø¯ Ùˆ ÙˆØ§Ø¶Ø­ Ø¨Ø®ÙˆØ§Ù†ÛŒØ¯",
            "Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ø®Ø´ÛŒ Ø§Ø² Ù…Ø¬Ù…ÙˆØ¹Ù‡ ØªØªØ±Ø§Ø´Ø§Ù¾ Ù…ÛŒâ€ŒØ¨Ø§Ø´Ø¯",
            "ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ú©Ø§Ø±Ø¨Ø±Ø¯Ù‡Ø§ÛŒ ÙØ±Ø§ÙˆØ§Ù†ÛŒ Ø¯Ø± ÙÙ†Ø§ÙˆØ±ÛŒ Ø¯Ø§Ø±Ø¯"
        ];
        
        // Ø¯Ø³ØªÙˆØ±Ø§Øª ØµÙˆØªÛŒ
        const voiceCommands = {
            'Ù†Ù‚Ø·Ù‡': '. ',
            'ÙˆÛŒØ±Ú¯ÙˆÙ„': ', ',
            'Ø¹Ù„Ø§Ù…Øª Ø³ÙˆØ§Ù„': 'ØŸ ',
            'Ø®Ø· Ø¬Ø¯ÛŒØ¯': '\\n',
            'Ù¾Ø§Ú© Ú©Ù†': 'CLEAR',
            'Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†': 'SAVE',
            'ØªÙˆÙ‚Ù': 'STOP'
        };
        
        // Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…Ø§ÛŒØ´Ú¯Ø± Ù…ÙˆØ¬ ØµÙˆØªÛŒ
        function createWaveVisualizer() {
            audioVisualizer.innerHTML = '';
            waveBars = [];
            
            const barCount = 50;
            for(let i = 0; i < barCount; i++) {
                const bar = document.createElement('div');
                bar.className = 'wave-bar';
                bar.style.left = \`\${(i / barCount) * 100}%\`;
                bar.style.height = '5px';
                audioVisualizer.appendChild(bar);
                waveBars.push(bar);
            }
        }
        
        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´Ú¯Ø± Ù…ÙˆØ¬
        function updateWaveVisualizer(level) {
            const barsToUpdate = Math.floor((level / 100) * waveBars.length);
            
            waveBars.forEach((bar, index) => {
                if(index < barsToUpdate) {
                    const height = 5 + Math.random() * 100;
                    bar.style.height = \`\${height}px\`;
                    bar.style.background = \`hsl(\${200 + (height/2)}, 100%, 60%)\`;
                } else {
                    bar.style.height = '5px';
                }
            });
            
            volumeLevel.textContent = \`Ø³Ø·Ø­: \${Math.round(level)}%\`;
        }
        
        // Ø´Ø±ÙˆØ¹ Ø¶Ø¨Ø·
        function startRecording() {
            if(isRecording) return;
            
            isRecording = true;
            startBtn.disabled = true;
            stopBtn.disabled = false;
            
            transcript.innerHTML = '<span style="color: #4CAF50;">â— Ø¯Ø± Ø­Ø§Ù„ Ø¶Ø¨Ø·... ØµØ­Ø¨Øª Ú©Ù†ÛŒØ¯</span>';
            
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø³Ø·Ø­ ØµØ¯Ø§
            let volume = 0;
            const volumeSimulation = setInterval(() => {
                if(!isRecording) {
                    clearInterval(volumeSimulation);
                    return;
                }
                
                volume = 20 + Math.random() * 80;
                updateWaveVisualizer(volume);
                
                // Ú¯Ø§Ù‡ÛŒ Ø§ÙˆÙ‚Ø§Øª Ù…ØªÙ† Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
                if(Math.random() > 0.7 && volume > 50) {
                    addSampleText();
                }
            }, 100);
            
            // ØªØ§ÛŒÙ…Ø± Ø¶Ø¨Ø·
            recordingTimer = 0;
            timerInterval = setInterval(() => {
                recordingTimer++;
                const minutes = Math.floor(recordingTimer / 60).toString().padStart(2, '0');
                const seconds = (recordingTimer % 60).toString().padStart(2, '0');
                recordTime.textContent = \`\${minutes}:\${seconds}\`;
            }, 1000);
            
            // Ø¯Ø± Ø­Ø§Ù„Øª ÙˆØ§Ù‚Ø¹ÛŒ Ø§ÛŒÙ†Ø¬Ø§ Web Speech API ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯
            // const recognition = new webkitSpeechRecognition();
            // recognition.lang = 'fa-IR';
            // recognition.start();
        }
        
        // ØªÙˆÙ‚Ù Ø¶Ø¨Ø·
        function stopRecording() {
            isRecording = false;
            startBtn.disabled = false;
            stopBtn.disabled = true;
            
            transcript.innerHTML += '<br><span style="color: #FF9800;">â¹ï¸ Ø¶Ø¨Ø· Ù…ØªÙˆÙ‚Ù Ø´Ø¯</span>';
            updateWaveVisualizer(0);
            
            clearInterval(timerInterval);
        }
        
        // Ø§ÙØ²ÙˆØ¯Ù† Ù…ØªÙ† Ù†Ù…ÙˆÙ†Ù‡
        function addSampleText() {
            const sample = persianSamples[Math.floor(Math.random() * persianSamples.length)];
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªÙˆØ±Ø§Øª ØµÙˆØªÛŒ
            let processedSample = sample;
            Object.keys(voiceCommands).forEach(command => {
                if(sample.includes(command)) {
                    processedSample = processedSample.replace(command, voiceCommands[command]);
                }
            });
            
            // Ø­Ø°Ù Ø¯Ø³ØªÙˆØ±Ø§Øª Ø®Ø§Øµ
            if(processedSample.includes('CLEAR')) {
                clearTranscript();
                return;
            }
            
            if(processedSample.includes('SAVE')) {
                saveTranscript();
                return;
            }
            
            // Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ù…ØªÙ† Ù…ÙˆØ¬ÙˆØ¯
            const currentText = transcript.textContent;
            const newText = currentText.replace('â— Ø¯Ø± Ø­Ø§Ù„ Ø¶Ø¨Ø·... ØµØ­Ø¨Øª Ú©Ù†ÛŒØ¯', '') + processedSample + ' ';
            
            transcript.innerHTML = \`
                <span style="color: #4CAF50;">â— Ø¯Ø± Ø­Ø§Ù„ Ø¶Ø¨Ø·... ØµØ­Ø¨Øª Ú©Ù†ÛŒØ¯</span><br>
                \${newText}
            \`;
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª
            const words = newText.split(/\\s+/).filter(w => w.length > 0);
            wordCount.textContent = words.length;
        }
        
        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…ØªÙ†
        function clearTranscript() {
            if(confirm('Ø¢ÛŒØ§ Ø§Ø² Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…ØªÙ† Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')) {
                transcript.innerHTML = 'Ù…ØªÙ† Ù¾Ø§Ú© Ø´Ø¯. Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯ Ø¯Ú©Ù…Ù‡ "Ø´Ø±ÙˆØ¹ Ø¶Ø¨Ø·" Ø±Ø§ ÙØ´Ø§Ø± Ø¯Ù‡ÛŒØ¯.';
                wordCount.textContent = 'Û°';
                recordingTimer = 0;
                recordTime.textContent = 'Û°Û°:Û°Û°';
                clearInterval(timerInterval);
            }
        }
        
        // ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ Ú¯ÙØªØ§Ø±
        function playTextToSpeech() {
            const text = transcript.textContent.replace('â— Ø¯Ø± Ø­Ø§Ù„ Ø¶Ø¨Ø·... ØµØ­Ø¨Øª Ú©Ù†ÛŒØ¯', '');
            
            if(text.trim().length === 0) {
                alert('Ù…ØªÙ†ÛŒ Ø¨Ø±Ø§ÛŒ Ù¾Ø®Ø´ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯!');
                return;
            }
            
            // Ø¯Ø± Ø­Ø§Ù„Øª ÙˆØ§Ù‚Ø¹ÛŒ Ø§Ø² Web Speech API Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
            // const utterance = new SpeechSynthesisUtterance(text);
            // utterance.lang = 'fa-IR';
            // speechSynthesis.speak(utterance);
            
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ
            transcript.innerHTML += \`
                <br><span style="color: #2196F3;">ğŸ”Š Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´ ØµÙˆØªÛŒ...</span>
            \`;
            
            setTimeout(() => {
                transcript.innerHTML = transcript.innerHTML.replace('Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´ ØµÙˆØªÛŒ...', 'Ù¾Ø®Ø´ ØµÙˆØªÛŒ Ú©Ø§Ù…Ù„ Ø´Ø¯ âœ“');
            }, 2000);
        }
        
        // Ø°Ø®ÛŒØ±Ù‡ Ù…ØªÙ†
        function saveTranscript() {
            const text = transcript.textContent;
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Ù…ØªÙ†-ØªØ´Ø®ÛŒØµ-Ú¯ÙØªØ§Ø±.txt';
            a.click();
            
            const now = new Date();
            const timeString = now.getHours().toString().padStart(2, '0') + ':' + 
                              now.getMinutes().toString().padStart(2, '0');
            document.getElementById('lastSave').textContent = timeString;
            
            transcript.innerHTML += \`
                <br><span style="color: #8BC34A;">ğŸ’¾ Ù…ØªÙ† Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯ (\${timeString})</span>
            \`;
        }
        
        // ØªÙ†Ø¸ÛŒÙ… Ø­Ø³Ø§Ø³ÛŒØª
        sensitivitySlider.addEventListener('input', function() {
            sensitivityValue.textContent = \`\${this.value}Ùª\`;
        });
        
        // Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø³ØªÙˆØ±Ø§Øª ØµÙˆØªÛŒ Ù†Ù…Ø§ÛŒØ´ÛŒ
        function setupVoiceCommands() {
            const commandsDiv = document.createElement('div');
            commandsDiv.style.marginTop = '20px';
            commandsDiv.style.padding = '15px';
            commandsDiv.style.background = 'rgba(255,255,255,0.05)';
            commandsDiv.style.borderRadius = '10px';
            
            commandsDiv.innerHTML = \`
                <h4>ğŸ¯ Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø³Ø±ÛŒØ¹ØŒ Ø§ÛŒÙ† Ø¬Ù…Ù„Ø§Øª Ø±Ø§ Ø¨Ú¯ÙˆÛŒÛŒØ¯:</h4>
                <p style="color: #FFCC80;">"\${persianSamples[0]}"</p>
                <p style="color: #FFCC80;">"\${persianSamples[1]}"</p>
                <p><small>(Ø³ÛŒØ³ØªÙ… Ø¨Ù‡ ØµÙˆØ±Øª Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ù¾Ø§Ø³Ø® Ù…ÛŒâ€ŒØ¯Ù‡Ø¯)</small></p>
            \`;
            
            document.querySelector('.recognition-area').appendChild(commandsDiv);
        }
        
        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        window.onload = function() {
            createWaveVisualizer();
            setupVoiceCommands();
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø²Ù…Ø§Ù† Ø°Ø®ÛŒØ±Ù‡
            const now = new Date();
            const timeString = now.getHours().toString().padStart(2, '0') + ':' + 
                              now.getMinutes().toString().padStart(2, '0');
            document.getElementById('lastSave').textContent = timeString;
        };
    </script>
</body>
</html>
