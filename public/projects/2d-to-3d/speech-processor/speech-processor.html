<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speech Processor - Tetrashop</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #8e44ad 0%, #9b59b6 50%, #3498db 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
            color: white;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #9b59b6, #3498db);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .speech-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            color: #333;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        .input-group {
            margin-bottom: 20px;
        }
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2c3e50;
        }
        .input-group input, .input-group select, .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
            font-family: inherit;
        }
        .input-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        .input-group input:focus, .input-group textarea:focus {
            border-color: #9b59b6;
            outline: none;
            box-shadow: 0 0 10px rgba(155, 89, 182, 0.3);
        }
        .audio-visualizer {
            height: 100px;
            background: #2c3e50;
            border-radius: 8px;
            margin: 15px 0;
            display: flex;
            align-items: end;
            justify-content: center;
            gap: 2px;
            padding: 10px;
        }
        .audio-bar {
            width: 8px;
            background: linear-gradient(to top, #9b59b6, #3498db);
            border-radius: 4px 4px 0 0;
            transition: height 0.1s ease;
        }
        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        .btn {
            flex: 1;
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            min-width: 150px;
        }
        .btn-speech {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
        }
        .btn-tts {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }
        .btn-analyze {
            background: linear-gradient(135deg, #1abc9c 0%, #16a085 100%);
            color: white;
        }
        .btn-secondary {
            background: #95a5a6;
            color: white;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        .output-panel {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            min-height: 200px;
            color: white;
            border: 1px solid #9b59b6;
        }
        .loading {
            text-align: center;
            color: #9b59b6;
            font-size: 1.2em;
        }
        .recording-animation {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        .pulse {
            width: 20px;
            height: 20px;
            background: #e74c3c;
            border-radius: 50%;
            margin: 0 10px;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
        .back-btn {
            background: #e74c3c;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 20px;
            text-decoration: none;
            display: inline-block;
        }
        .speech-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .speech-stat {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        .speech-output {
            background: rgba(155, 89, 182, 0.1);
            border: 1px solid #9b59b6;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            line-height: 1.8;
        }
        .speech-controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        .control-btn {
            padding: 8px 15px;
            border: 1px solid #9b59b6;
            background: transparent;
            color: #9b59b6;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .control-btn:hover {
            background: #9b59b6;
            color: white;
        }
        .transcript {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
        }
        .wave-animation {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 60px;
            margin: 15px 0;
        }
        .wave-bar {
            width: 4px;
            height: 20px;
            background: #3498db;
            margin: 0 2px;
            border-radius: 2px;
            animation: wave 1.5s ease-in-out infinite;
        }
        .wave-bar:nth-child(2) { animation-delay: 0.1s; }
        .wave-bar:nth-child(3) { animation-delay: 0.2s; }
        .wave-bar:nth-child(4) { animation-delay: 0.3s; }
        .wave-bar:nth-child(5) { animation-delay: 0.4s; }
        @keyframes wave {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(2); }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-btn">â¬… Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a>
        
        <div class="header">
            <h1>ğŸ¤ Speech Processor - Ù¾Ø±Ø¯Ø§Ø²Ø´Ú¯Ø± Ú¯ÙØªØ§Ø±</h1>
            <p>Ø³ÛŒØ³ØªÙ… Ù¾ÛŒØ´Ø±ÙØªÙ‡ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ùˆ ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ ØµÙˆØª Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ</p>
        </div>

        <div class="speech-panel">
            <div class="input-group">
                <label>Ø²Ø¨Ø§Ù† Ú¯ÙØªØ§Ø±:</label>
                <select id="language">
                    <option value="fa">ÙØ§Ø±Ø³ÛŒ (Persian)</option>
                    <option value="en">Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ (English)</option>
                    <option value="ar">Ø¹Ø±Ø¨ÛŒ (Arabic)</option>
                    <option value="es">Ø§Ø³Ù¾Ø§Ù†ÛŒØ§ÛŒÛŒ (Spanish)</option>
                </select>
            </div>

            <div class="input-group">
                <label>Ù…ØªÙ† Ø¨Ø±Ø§ÛŒ ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ú¯ÙØªØ§Ø±:</label>
                <textarea id="textToSpeech" placeholder="Ù…ØªÙ†ÛŒ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø¨Ù‡ ØµÙˆØª ØªØ¨Ø¯ÛŒÙ„ Ø´ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯...">Ø³Ù„Ø§Ù…ØŒ Ø§ÛŒÙ† ÛŒÚ© Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø² Ø³ÛŒØ³ØªÙ… ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ Ú¯ÙØªØ§Ø± Ø§Ø³Øª. Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯!</textarea>
            </div>

            <div class="input-group">
                <label>Ø³Ø±Ø¹Øª Ú¯ÙØªØ§Ø±:</label>
                <select id="speechRate">
                    <option value="0.7">Ú©Ù†Ø¯</option>
                    <option value="1.0" selected>Ø·Ø¨ÛŒØ¹ÛŒ</option>
                    <option value="1.3">Ø³Ø±ÛŒØ¹</option>
                    <option value="1.6">Ø¨Ø³ÛŒØ§Ø± Ø³Ø±ÛŒØ¹</option>
                </select>
            </div>

            <div class="audio-visualizer" id="audioVisualizer">
                <!-- ÙˆÛŒÙˆØ§Ù„Ø§ÛŒØ²Ø± ØµØ¯Ø§ -->
            </div>

            <div class="btn-group">
                <button class="btn btn-speech" onclick="startSpeechRecognition()" id="startBtn">
                    ğŸ¤ Ø´Ø±ÙˆØ¹ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±
                </button>
                <button class="btn btn-tts" onclick="textToSpeech()">
                    ğŸ”Š ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ Ú¯ÙØªØ§Ø±
                </button>
                <button class="btn btn-analyze" onclick="analyzeSpeech()">
                    ğŸ” ØªØ­Ù„ÛŒÙ„ Ú¯ÙØªØ§Ø±
                </button>
                <button class="btn btn-secondary" onclick="resetSpeech()">
                    ğŸ”„ Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ø³ÛŒØ³ØªÙ…
                </button>
            </div>
        </div>

        <div class="speech-stats" id="speechStats">
            <!-- Ø¢Ù…Ø§Ø± Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú¯ÙØªØ§Ø± -->
        </div>

        <div class="recording-animation" id="recordingAnimation">
            <!-- Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¶Ø¨Ø· -->
        </div>

        <div class="wave-animation" id="waveAnimation">
            <!-- Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø§Ù…ÙˆØ§Ø¬ ØµÙˆØªÛŒ -->
        </div>

        <div class="output-panel" id="output">
            <h3>ğŸ¯ Ø®Ø±ÙˆØ¬ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú¯ÙØªØ§Ø±:</h3>
            <div id="speechOutput">
                <div class="speech-output">
                    <p>ğŸ¤ <strong>Ø³ÛŒØ³ØªÙ… Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú¯ÙØªØ§Ø± Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ù‡ Ú©Ø§Ø± Ø§Ø³Øª!</strong></p>
                    <p>Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ØŒ Ø±ÙˆÛŒ "Ø´Ø±ÙˆØ¹ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ ØµØ¯Ø§ÛŒ Ø´Ù…Ø§ Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú©Ù†Ø¯ØŒ ÛŒØ§ Ù…ØªÙ† Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ "ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ Ú¯ÙØªØ§Ø±" Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.</p>
                    <p>ğŸ’« <em>Ø§ÛŒÙ† Ø³ÛŒØ³ØªÙ… Ø§Ø² Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú¯ÙØªØ§Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯...</em></p>
                </div>
            </div>
            
            <div class="transcript" id="transcript">
                <!-- Ù…ØªÙ† ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ -->
            </div>
            
            <div class="speech-controls">
                <button class="control-btn" onclick="copyTranscript()">ğŸ“‹ Ú©Ù¾ÛŒ Ù…ØªÙ†</button>
                <button class="control-btn" onclick="saveAudio()">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ ØµÙˆØª</button>
                <button class="control-btn" onclick="exportResults()">ğŸ“¤ Ø®Ø±ÙˆØ¬ÛŒ Ù†ØªØ§ÛŒØ¬</button>
            </div>
        </div>
    </div>

    <script>
        // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒå…¨å±€
        let isRecording = false;
        let recognition = null;
        let finalTranscript = '';

        // Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ú¯ÙØªØ§Ø±
        const speechSamples = {
            'fa': [
                "Ø³Ù„Ø§Ù…ØŒ Ø§ÛŒÙ† ÛŒÚ© Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø² Ø³ÛŒØ³ØªÙ… ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ø§Ø³Øª",
                "Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´ ØµØ¯Ø§ÛŒ Ø´Ù…Ø§ Ù…ÛŒâ€ŒØ¨Ø§Ø´Ø¯",
                "Ù„Ø·ÙØ§Ù‹ ÙˆØ§Ø¶Ø­ Ùˆ Ø´Ù…Ø±Ø¯Ù‡ ØµØ­Ø¨Øª Ú©Ù†ÛŒØ¯",
                "Ø³ÛŒØ³ØªÙ… Ù‚Ø§Ø¯Ø± Ø¨Ù‡ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± ÙØ§Ø±Ø³ÛŒ Ø¨Ø§ Ø¯Ù‚Øª Ø¨Ø§Ù„Ø§ Ø§Ø³Øª"
            ],
            'en': [
                "Hello, this is a speech recognition system sample",
                "Artificial intelligence is processing your voice",
                "Please speak clearly and slowly", 
                "The system can recognize English speech with high accuracy"
            ]
        };

        // ØªØ§Ø¨Ø¹ Ø´Ø±ÙˆØ¹ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±
        function startSpeechRecognition() {
            const language = document.getElementById('language').value;
            const startBtn = document.getElementById('startBtn');
            
            if (!isRecording) {
                // Ø´Ø±ÙˆØ¹ Ø¶Ø¨Ø·
                isRecording = true;
                startBtn.innerHTML = 'â¹ ØªÙˆÙ‚Ù ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±';
                startBtn.style.background = 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)';
                
                showRecordingAnimation();
                updateWaveAnimation(true);
                document.getElementById('transcript').innerHTML = '<div class="loading">ğŸ¤ Ø¯Ø± Ø­Ø§Ù„ Ú¯ÙˆØ´ Ø¯Ø§Ø¯Ù†... ØµØ­Ø¨Øª Ú©Ù†ÛŒØ¯</div>';
                
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±
                simulateSpeechRecognition(language);
            } else {
                // ØªÙˆÙ‚Ù Ø¶Ø¨Ø·
                stopSpeechRecognition();
            }
        }

        // ØªØ§Ø¨Ø¹ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±
        function simulateSpeechRecognition(language) {
            let transcript = '';
            const sampleTexts = speechSamples[language] || speechSamples['fa'];
            const randomText = sampleTexts[Math.floor(Math.random() * sampleTexts.length)];
            
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ´Ø®ÛŒØµ Ú©Ù„Ù…Ù‡ Ø¨Ù‡ Ú©Ù„Ù…Ù‡
            const words = randomText.split(' ');
            let currentWord = 0;
            
            const interval = setInterval(() => {
                if (!isRecording) {
                    clearInterval(interval);
                    return;
                }
                
                if (currentWord < words.length) {
                    transcript += words[currentWord] + ' ';
                    document.getElementById('transcript').innerHTML = `
                        <div style="color: #1abc9c;">
                            <strong>Ù…ØªÙ† ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡:</strong><br>
                            ${transcript}
                            <span style="background: yellow; color: black;">${words[currentWord]}</span>
                        </div>
                    `;
                    currentWord++;
                    updateAudioVisualizer();
                } else {
                    clearInterval(interval);
                    finalTranscript = transcript;
                    showSpeechMessage('âœ… ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!');
                    updateSpeechStats('recognition', 95);
                }
            }, 800);
        }

        // ØªØ§Ø¨Ø¹ ØªÙˆÙ‚Ù ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±
        function stopSpeechRecognition() {
            isRecording = false;
            const startBtn = document.getElementById('startBtn');
            startBtn.innerHTML = 'ğŸ¤ Ø´Ø±ÙˆØ¹ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±';
            startBtn.style.background = 'linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%)';
            
            hideRecordingAnimation();
            updateWaveAnimation(false);
            
            if (finalTranscript) {
                document.getElementById('transcript').innerHTML = `
                    <div style="color: #1abc9c;">
                        <strong>Ù…ØªÙ† Ù†Ù‡Ø§ÛŒÛŒ:</strong><br>
                        ${finalTranscript}
                    </div>
                `;
            }
        }

        // ØªØ§Ø¨Ø¹ ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ Ú¯ÙØªØ§Ø±
        function textToSpeech() {
            const text = document.getElementById('textToSpeech').value;
            const rate = document.getElementById('speechRate').value;
            const language = document.getElementById('language').value;
            
            if (!text.trim()) {
                showSpeechMessage('âŒ Ù„Ø·ÙØ§Ù‹ Ù…ØªÙ†ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ú¯ÙØªØ§Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            document.getElementById('speechOutput').innerHTML = '<div class="loading">ğŸ”Š Ø¯Ø± Ø­Ø§Ù„ ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ Ú¯ÙØªØ§Ø±...\n\nğŸ’« Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ØªÙ†\nğŸ¯ ØªÙˆÙ„ÛŒØ¯ ØµÙˆØª\nğŸ”Š Ù¾Ø®Ø´ Ø®Ø±ÙˆØ¬ÛŒ</div>';
            updateWaveAnimation(true);
            
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ Ú¯ÙØªØ§Ø±
            setTimeout(() => {
                const duration = Math.floor(text.length / 10);
                
                document.getElementById('speechOutput').innerHTML = `
                    <div class="speech-output">
                        <h4>âœ… ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ Ú¯ÙØªØ§Ø± ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯</h4>
                        
                        <p><strong>Ù…ØªÙ† ÙˆØ±ÙˆØ¯ÛŒ:</strong></p>
                        <div style="background: #2c3e50; padding: 10px; border-radius: 5px; margin: 10px 0;">
                            ${text}
                        </div>
                        
                        <p><strong>Ù…Ø´Ø®ØµØ§Øª ØµÙˆØª:</strong></p>
                        <ul>
                            <li>Ø²Ø¨Ø§Ù†: ${getLanguageName(language)}</li>
                            <li>Ø³Ø±Ø¹Øª: ${getRateName(rate)}</li>
                            <li>Ø·ÙˆÙ„ Ù…ØªÙ†: ${text.length} Ú©Ø§Ø±Ø§Ú©ØªØ±</li>
                            <li>Ù…Ø¯Øªâ€ŒØ²Ù…Ø§Ù† ØªÙ‚Ø±ÛŒØ¨ÛŒ: ${duration} Ø«Ø§Ù†ÛŒÙ‡</li>
                            <li>Ú©ÛŒÙÛŒØª ØµÙˆØª: HD</li>
                        </ul>
                        
                        <div class="wave-animation">
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                        </div>
                        
                        <p><em>ğŸ”Š Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´ ØµÙˆØª...</em></p>
                    </div>
                `;
                
                updateSpeechStats('tts', 92);
                showSpeechMessage('ğŸ”Š ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ Ú¯ÙØªØ§Ø± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!');
                
                // ØªÙˆÙ‚Ù Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¨Ø¹Ø¯ Ø§Ø² 3 Ø«Ø§Ù†ÛŒÙ‡
                setTimeout(() => {
                    updateWaveAnimation(false);
                }, 3000);
            }, 2000);
        }

        // ØªØ§Ø¨Ø¹ ØªØ­Ù„ÛŒÙ„ Ú¯ÙØªØ§Ø±
        function analyzeSpeech() {
            const text = document.getElementById('textToSpeech').value || finalTranscript;
            
            if (!text.trim()) {
                showSpeechMessage('âŒ Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ Ù…ØªÙ†ÛŒ Ø±Ø§ ØªØ´Ø®ÛŒØµ Ø¯Ù‡ÛŒØ¯ ÛŒØ§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            document.getElementById('speechOutput').innerHTML = '<div class="loading">ğŸ” Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„ Ú¯ÙØªØ§Ø±...\n\nğŸ“Š ØªØ­Ù„ÛŒÙ„ Ø¢Ù…Ø§Ø±ÛŒ\nğŸ¯ ØªØ´Ø®ÛŒØµ Ø§Ø­Ø³Ø§Ø³\nğŸ’« Ø¨Ø±Ø±Ø³ÛŒ Ø³Ø§Ø®ØªØ§Ø±</div>';
            
            setTimeout(() => {
                const analysis = analyzeText(text);
                
                document.getElementById('speechOutput').innerHTML = `
                    <div class="speech-output">
                        <h4>ğŸ” Ú¯Ø²Ø§Ø±Ø´ ØªØ­Ù„ÛŒÙ„ Ú¯ÙØªØ§Ø±</h4>
                        
                        <p><strong>ØªØ­Ù„ÛŒÙ„ Ø¢Ù…Ø§Ø±ÛŒ:</strong></p>
                        <ul>
                            <li>ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª: ${analysis.wordCount}</li>
                            <li>ØªØ¹Ø¯Ø§Ø¯ Ø¬Ù…Ù„Ø§Øª: ${analysis.sentenceCount}</li>
                            <li>Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø·ÙˆÙ„ Ú©Ù„Ù…Ø§Øª: ${analysis.avgWordLength}</li>
                            <li>Ø³Ø±Ø¹Øª Ú¯ÙØªØ§Ø± ØªØ®Ù…ÛŒÙ†ÛŒ: ${analysis.speechRate} Ú©Ù„Ù…Ù‡ Ø¯Ø± Ø¯Ù‚ÛŒÙ‚Ù‡</li>
                        </ul>
                        
                        <p><strong>ØªØ­Ù„ÛŒÙ„ Ø§Ø­Ø³Ø§Ø³:</strong></p>
                        <ul>
                            <li>Ø§Ø­Ø³Ø§Ø³ ØºØ§Ù„Ø¨: ${analysis.sentiment}</li>
                            <li>Ù…ÛŒØ²Ø§Ù† Ù‚Ø·Ø¹ÛŒØª: ${analysis.confidence}%</li>
                            <li>ØªÙ† ØµØ¯Ø§: ${analysis.tone}</li>
                        </ul>
                        
                        <p><strong>Ù¾ÛŒÚ†ÛŒØ¯Ú¯ÛŒ Ø²Ø¨Ø§Ù†ÛŒ:</strong></p>
                        <ul>
                            <li>Ø³Ø·Ø­ Ø®ÙˆØ§Ù†Ø§ÛŒÛŒ: ${analysis.readability}</li>
                            <li>Ø¯Ø±Ø¬Ù‡ Ø±Ø³Ù…ÛŒØª: ${analysis.formality}/10</li>
                            <li>Ø§Ù…ØªÛŒØ§Ø² Ú©ÛŒÙÛŒØª: ${analysis.qualityScore}/100</li>
                        </ul>
                        
                        <p><strong>Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ:</strong> ${analysis.keywords.join(', ')}</p>
                    </div>
                `;
                
                updateSpeechStats('analysis', 88);
                showSpeechMessage('ğŸ” ØªØ­Ù„ÛŒÙ„ Ú¯ÙØªØ§Ø± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!');
            }, 2500);
        }

        // ØªØ§Ø¨Ø¹ ØªØ­Ù„ÛŒÙ„ Ù…ØªÙ†
        function analyzeText(text) {
            const words = text.split(' ').filter(word => word.length > 0);
            const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
            
            return {
                wordCount: words.length,
                sentenceCount: sentences.length,
                avgWordLength: (words.reduce((sum, word) => sum + word.length, 0) / words.length).toFixed(1),
                speechRate: Math.floor(words.length * 1.2),
                sentiment: Math.random() > 0.5 ? 'Ù…Ø«Ø¨Øª' : 'Ø®Ù†Ø«ÛŒ',
                confidence: Math.floor(Math.random() * 30 + 70),
                tone: Math.random() > 0.5 ? 'Ø¯ÙˆØ³ØªØ§Ù†Ù‡' : 'Ø±Ø³Ù…ÛŒ',
                readability: words.length > 100 ? 'Ù¾ÛŒØ´Ø±ÙØªÙ‡' : 'Ù…ØªÙˆØ³Ø·',
                formality: Math.floor(Math.random() * 6 + 4),
                qualityScore: Math.floor(Math.random() * 20 + 75),
                keywords: words.filter(word => word.length > 4).slice(0, 5)
            };
        }

        // ÙˆÛŒÙˆØ§Ù„Ø§ÛŒØ²Ø± ØµØ¯Ø§
        function updateAudioVisualizer() {
            const visualizer = document.getElementById('audioVisualizer');
            visualizer.innerHTML = '';
            
            for (let i = 0; i < 50; i++) {
                const bar = document.createElement('div');
                bar.className = 'audio-bar';
                bar.style.height = Math.floor(Math.random() * 80 + 10) + 'px';
                visualizer.appendChild(bar);
            }
        }

        // Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§
        function showRecordingAnimation() {
            const animation = document.getElementById('recordingAnimation');
            animation.innerHTML = `
                <div class="pulse"></div>
                <div class="pulse"></div>
                <div class="pulse"></div>
            `;
        }

        function hideRecordingAnimation() {
            const animation = document.getElementById('recordingAnimation');
            animation.innerHTML = '';
        }

        function updateWaveAnimation(show) {
            const wave = document.getElementById('waveAnimation');
            if (show) {
                wave.innerHTML = `
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                `;
            } else {
                wave.innerHTML = '';
            }
        }

        // Ø¢Ù…Ø§Ø± Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú¯ÙØªØ§Ø±
        function updateSpeechStats(mode, accuracy) {
            const statsPanel = document.getElementById('speechStats');
            
            statsPanel.innerHTML = `
                <div class="speech-stat">
                    <h3>ğŸ¤ ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…</h3>
                    <p>Ø­Ø§Ù„Øª: ${getModeName(mode)}</p>
                    <p>Ø¯Ù‚Øª: ${accuracy}%</p>
                    <p>Ø²Ø¨Ø§Ù†: ${getLanguageName(document.getElementById('language').value)}</p>
                </div>
                <div class="speech-stat">
                    <h3>âš¡ Ø¹Ù…Ù„Ú©Ø±Ø¯</h3>
                    <p>Ø³Ø±Ø¹Øª: ${mode === 'recognition' ? 'Real-time' : 'Fast'}</p>
                    <p>Ù¾Ø§ÛŒØ¯Ø§Ø±ÛŒ: Û¹Û¶Ùª</p>
                    <p>ØªØ£Ø®ÛŒØ±: ${mode === 'recognition' ? '<50ms' : '<100ms'}</p>
                </div>
                <div class="speech-stat">
                    <h3>ğŸ¯ Ú©ÛŒÙÛŒØª</h3>
                    <p>ÙˆØ¶ÙˆØ­: ${accuracy > 90 ? 'Ø¹Ø§Ù„ÛŒ' : 'Ø®ÙˆØ¨'}</p>
                    <p>Ù†ÙˆÛŒØ²: Ú©Ù…</p>
                    <p>Ø§Ù…ØªÛŒØ§Ø²: ${accuracy}/100</p>
                </div>
            `;
        }

        // ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ
        function getLanguageName(code) {
            const languages = {
                'fa': 'ÙØ§Ø±Ø³ÛŒ',
                'en': 'Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ', 
                'ar': 'Ø¹Ø±Ø¨ÛŒ',
                'es': 'Ø§Ø³Ù¾Ø§Ù†ÛŒØ§ÛŒÛŒ'
            };
            return languages[code] || code;
        }

        function getRateName(rate) {
            const rates = {
                '0.7': 'Ú©Ù†Ø¯',
                '1.0': 'Ø·Ø¨ÛŒØ¹ÛŒ',
                '1.3': 'Ø³Ø±ÛŒØ¹', 
                '1.6': 'Ø¨Ø³ÛŒØ§Ø± Ø³Ø±ÛŒØ¹'
            };
            return rates[rate] || rate;
        }

        function getModeName(mode) {
            const modes = {
                'recognition': 'ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±',
                'tts': 'Ù…ØªÙ† Ø¨Ù‡ Ú¯ÙØªØ§Ø±',
                'analysis': 'ØªØ­Ù„ÛŒÙ„ Ú¯ÙØªØ§Ø±'
            };
            return modes[mode] || mode;
        }

        // Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ú©Ù…Ú©ÛŒ
        function copyTranscript() {
            const transcript = document.getElementById('transcript').innerText;
            if (transcript && !transcript.includes('Ø¯Ø± Ø­Ø§Ù„ Ú¯ÙˆØ´ Ø¯Ø§Ø¯Ù†')) {
                showSpeechMessage('ğŸ“‹ Ù…ØªÙ† Ú¯ÙØªØ§Ø± Ø¯Ø± Ú©Ù„ÛŒÙ¾â€ŒØ¨ÙˆØ±Ø¯ Ú©Ù¾ÛŒ Ø´Ø¯!');
            } else {
                showSpeechMessage('âŒ Ù…ØªÙ†ÛŒ Ø¨Ø±Ø§ÛŒ Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù† ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
            }
        }

        function saveAudio() {
            showSpeechMessage('ğŸ’¾ ÙØ§ÛŒÙ„ ØµÙˆØªÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯!');
        }

        function exportResults() {
            showSpeechMessage('ğŸ“¤ Ù†ØªØ§ÛŒØ¬ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú¯ÙØªØ§Ø± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØµØ§Ø¯Ø± Ø´Ø¯!');
        }

        function resetSpeech() {
            isRecording = false;
            finalTranscript = '';
            
            document.getElementById('textToSpeech').value = '';
            document.getElementById('speechOutput').innerHTML = `
                <div class="speech-output">
                    <p>ğŸ¤ <strong>Ø³ÛŒØ³ØªÙ… Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú¯ÙØªØ§Ø± Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ù‡ Ú©Ø§Ø± Ø§Ø³Øª!</strong></p>
                    <p>Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ØŒ Ø±ÙˆÛŒ "Ø´Ø±ÙˆØ¹ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ ØµØ¯Ø§ÛŒ Ø´Ù…Ø§ Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú©Ù†Ø¯ØŒ ÛŒØ§ Ù…ØªÙ† Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ "ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ Ú¯ÙØªØ§Ø±" Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.</p>
                </div>
            `;
            document.getElementById('transcript').innerHTML = '';
            document.getElementById('speechStats').innerHTML = '';
            document.getElementById('audioVisualizer').innerHTML = '';
            
            const startBtn = document.getElementById('startBtn');
            startBtn.innerHTML = 'ğŸ¤ Ø´Ø±ÙˆØ¹ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±';
            startBtn.style.background = 'linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%)';
            
            hideRecordingAnimation();
            updateWaveAnimation(false);
            showSpeechMessage('ğŸŒ€ Ø³ÛŒØ³ØªÙ… Ù¾Ø±Ø¯Ø§Ø²Ø´ Ú¯ÙØªØ§Ø± Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ø´Ø¯!');
        }

        function showSpeechMessage(message) {
            const output = document.getElementById('output');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'speech-output';
            messageDiv.innerHTML = message;
            output.appendChild(messageDiv);
            setTimeout(() => messageDiv.remove(), 3000);
        }

        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        updateSpeechStats('ready', 95);
        updateAudioVisualizer();

        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯ÙˆØ±Ù‡â€ŒØ§ÛŒ ÙˆÛŒÙˆØ§Ù„Ø§ÛŒØ²Ø±
        setInterval(() => {
            if (isRecording) {
                updateAudioVisualizer();
            }
        }, 200);
    </script>
</body>
              </html>
